<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>コマンドリファレンス | hydrocul のメモ</title>
<link rel="stylesheet" href="https://raw.github.com/necolas/normalize.css/master/normalize.css" type="text/css" />
<link rel="stylesheet" href="./common/css/common.css" type="text/css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<style>
#content {
  margin: 0 40px 0 40px;
  word-wrap: break-word;
}
#content h1 {
  margin: 20px 0 20px 0;
  border-bottom: 2px #CCC solid;
  padding-bottom: 4px
}
#content h2 {
  margin: 20px 0 20px 0;
  border-bottom: 1px #CCC solid;
  padding-bottom: 2px
}
#content h3 {
  margin: 20px 0 20px 40px;
}
#content p,
#content ul,
#content dl {
  margin: 10px 0 10px 40px;
}
#content ul {
  padding-left: 2em
}
#content pre {
  margin: 10px 0 10px 60px;
  border: 1px #CCC solid;
  padding: 4px;
}
#content blockquote {
  margin: 10px 0 10px 60px;
  border-left: 2px #CCC solid;
  padding-left: 8px;
}
footer {
  margin-left: 40px;
  margin-right: 40px;
  border-top: 1px solid #888;
  padding-top: 10px;
  text-align: right;
  font-size: 80%;
}
</style>
<script type="text/javascript">

  if(location.host == 'hydrocul.github.com'){

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-5853773-6']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  }

</script>
</head>
<body>
<div id="content">
<h1 id="section">コマンドリファレンス</h1>

<ul>
  <li><a href="#ack-grep">ack-grep</a></li>
  <li><a href="#base64">base64</a></li>
  <li><a href="#cp">cp</a></li>
  <li><a href="#date">date</a></li>
  <li><a href="#find">find</a></li>
  <li><a href="#git">git</a></li>
  <li><a href="#jhead">jhead</a></li>
  <li><a href="#less">less</a></li>
  <li><a href="#ls">ls</a></li>
  <li><a href="#lsof">lsof</a></li>
  <li><a href="#lftp">lftp</a></li>
  <li><a href="#mysql">mysql</a></li>
  <li><a href="#netstat">netstat</a></li>
  <li><a href="#rsync">rsync</a></li>
  <li><a href="#scala">scala</a></li>
  <li><a href="#scaladoc">scaladoc</a></li>
  <li><a href="#sed">sed</a></li>
  <li><a href="#source-highlight">source-highlight</a></li>
  <li><a href="#ssh">ssh</a></li>
  <li><a href="#tar">tar</a></li>
  <li><a href="#touch">touch</a></li>
  <li><a href="#tr">tr</a></li>
  <li><a href="#watch">watch</a></li>
  <li><a href="#wget">wget</a></li>
  <li><a href="#zip">zip</a></li>
</ul>

<h2 id="ack-grep">ack-grep</h2>

<h3 id="section-1">インストール</h3>

<p>Ubuntuの場合</p>

<pre><code>sudo apt-get install ack-grep
</code></pre>

<h3 id="section-2">対応しているファイルタイプの一覧を見るには</h3>

<pre><code>ack-grep --help-type
</code></pre>

<p>ファイルタイプの一覧をいじるには <code>/usr/share/perl5/App/Ack.pm</code> をいじる(apt-get でインストールした場合)。以下はmarkdown形式に対応させる例。</p>

<pre><code>--- Ack.pm
+++ Ack.pm
@@ -93,6 +93,7 @@
         lisp        =&gt; [qw( lisp lsp )],
         lua         =&gt; [qw( lua )],
         make        =&gt; q{Makefiles},
+        markdown    =&gt; [qw( md markdown )],
         mason       =&gt; [qw( mas mhtml mpl mtxt )],
         objc        =&gt; [qw( m h )],
         objcpp      =&gt; [qw( mm h )],
</code></pre>

<h2 id="base64">base64</h2>

<p>標準入力のデータをBASE64でエンコードまたはデコードして標準出力する。</p>

<pre><code>base64 -e # エンコード
base64 -d # デコード
</code></pre>

<p>変なところに改行があったりしてうまくデコードできない場合は</p>

<pre><code>cat src.txt | tr -d '\n' | base64 -d | dst.txt
</code></pre>

<p>ワンライナーでBASE64を扱ういろいろな方法<br />
<a href="http://dharry.hatenablog.com/entry/20120701/1341113739" target="_blank">http://dharry.hatenablog.com/entry/20120701/1341113739</a></p>

<h2 id="cp">cp</h2>

<dl>
  <dt><code>-i</code></dt>
  <dd>コピー先にすでにファイルが存在する場合は、上書きするかどうかを聞いてくる</dd>
  <dt><code>-p</code></dt>
  <dd>パーミッション、ユーザ・グループ、タイムスタンプもコピーする</dd>
  <dt><code>-r</code>, <code>-R</code></dt>
  <dd>ディレクトリの中を再帰的にコピーする</dd>
  <dt><code>-v</code></dt>
  <dd>ファイル名を表示しながらコピーする</dd>
</dl>

<h3 id="section-3">ディレクトリ名も含めてファイルをコピーするには</h3>

<pre><code>cp --parents abc/def/ghi.dat /home/who/
</code></pre>

<p>この場合、コピー先には <code>/home/who/ghi.dat</code> ではなく <code>/home/who/abc/def/ghi.dat</code> という名前でコピーされる。コピー先にディレクトリが存在しない場合は自動で作成される。</p>

<p><code>rsync</code> での同じ役割をはたすのは <code>-R</code>。</p>

<h2 id="date">date</h2>

<h3 id="yyyymmdd-hhmmss-">YYYYMMDD-hhmmss の書式で日時を出力する方法</h3>

<pre><code>date "+%Y%m%d-%H%M%S"
</code></pre>

<h2 id="find">find</h2>

<p><i>-&gt; <a href="find.html">find</a></i></p>

<h2 id="git">git</h2>

<p><i>-&gt; <a href="git.html">git</a></i></p>

<h2 id="jhead">jhead</h2>

<p>Exif Jpeg header manipulation tool<br />
<a href="http://www.sentex.net/~mwandel/jhead/" target="_blank">http://www.sentex.net/~mwandel/jhead/</a></p>

<h3 id="jpegexif">jpegのExif情報にある撮影日情報をもとにファイル名を変更するには</h3>

<pre><code>jhead -nf%Y-%m-%d-%H%M%S IMAG0000.jpg
</code></pre>

<h2 id="less">less</h2>

<ul>
  <li>オプション <code>-X</code> は、less 終了時に画面をクリアしない。</li>
  <li>オプション <code>-F</code> は、行数が短くて位置画面に収まる場合は less がすぐに終了する。</li>
  <li>オプション <code>-R</code> は、色などのエスケープシーケンスをそのとおりに解釈して
色付きで表示する。 <code>ls</code> は <code>--color</code> を付け、 <code>grep</code> は <code>--color=always</code> を
付けると色付きで出力される。</li>
</ul>

<p><code>-R</code> の例</p>

<pre><code>ls -alF --color | less -X -R
grep -rni --color=always abc | less -X -R
</code></pre>

<h2 id="ls">ls</h2>

<h3 id="yyyy-mm-dd-hhmmss-">タイムスタンプを <code>YYYY-MM-DD hh:mm:ss</code> のフォーマットで表示するには</h3>

<pre><code>ls -alF --time-style="+%Y-%m-%d %H:%M:%S"
</code></pre>

<p>find の場合</p>

<pre><code>find . -printf "%M %n %u %g %k %TY-%Tm-%Td %TH:%TM:%TS %p\n"
</code></pre>

<p><i>-&gt; <a href="find.html">find</a></i></p>

<h2 id="lsof">lsof</h2>

<p>lsofの使い方 - プロセスが使用中のファイルを調べる<br />
<a href="http://d.hatena.ne.jp/hogem/20070223/1172221315" target="_blank">http://d.hatena.ne.jp/hogem/20070223/1172221315</a><br />
ポートをLISTENしているプロセスを調べられる。</p>

<h2 id="lftp">lftp</h2>

<h3 id="ftp">FTPサーバの中のファイルリストを作成するには</h3>

<pre><code>lftp -c "open ユーザ名@ホスト名またはIP; find" | tee filelist.txt
</code></pre>

<h2 id="mysql">mysql</h2>

<p><i>-&gt; <a href="mysql.html">MySQL</a></i></p>

<h2 id="netstat">netstat</h2>

<h3 id="listen">ポートをLISTENしているプロセスを調べるには</h3>

<pre><code>netstat -anp
</code></pre>

<p>PIDの欄がプロセスIDである。root権限でないとプロセスIDが表示されないものがあるよう。</p>

<h2 id="rsync">rsync</h2>

<ul>
  <li>オプション <code>-u</code> は、タイムスタンプが新しいファイルのみをコピーする。</li>
</ul>

<h3 id="section-4">リモートホストからローカルにダウンロードするには</h3>

<pre><code>rsync リモートユーザ名@リモートホスト名:/絶対パス ローカルパス
</code></pre>

<h3 id="section-5">ポート番号が22以外の場合</h3>

<pre><code>rsync -e "ssh -p ポート番号" リモートユーザ名@リモートホスト名:/絶対パス ローカルパス
</code></pre>

<h3 id="section-6">秘密鍵のファイルを指定する場合</h3>

<pre><code>rsync -e "ssh -i 秘密鍵ファイル名" リモートユーザ名@リモートホスト名:/絶対パス ローカルパス
</code></pre>

<h3 id="section-7">ローカルにあるファイルをディレクトリ名も含めてリモートにアップロードするには</h3>

<pre><code>rsync -R abc/def/ghi.dat remote:/home/who/
</code></pre>

<p>この場合、リモートには <code>/home/who/ghi.dat</code> ではなく <code>/home/who/abc/def/ghi.dat</code> という名前でアップロードされる。リモートにディレクトリが存在しない場合は自動で作成される。</p>

<p><code>cp</code> での同じ役割をはたすのは <code>--parents</code>。</p>

<h2 id="scala">scala</h2>

<p>shebangで実行するには<br />
<a href="http://tech.caph.jp/2009/05/05/scala%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92shebang%E8%A1%8C%E3%81%A7%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF%E3%81%A9%E3%81%86%E3%81%99%E3%82%8C%E3%81%B0%E3%81%84/" target="_blank">http://tech.caph.jp/2009/05/05/scala%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92shebang%E8%A1%8C%E3%81%A7%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF%E3%81%A9%E3%81%86%E3%81%99%E3%82%8C%E3%81%B0%E3%81%84/</a></p>

<p>Macでscalaが文字化けする場合は<br />
<a href="http://hidemon-memo.blogspot.com/2010/07/scala-mac.html" target="_blank">http://hidemon-memo.blogspot.com/2010/07/scala-mac.html</a></p>

<h3 id="scala-">scala のクラスパスを指定するオプション</h3>

<pre><code>scala -classpath ...
</code></pre>

<p>または</p>

<pre><code>scala -cp ...
</code></pre>

<h2 id="scaladoc">scaladoc</h2>

<p>man page<br />
<a href="http://www.scala-lang.org/docu/files/tools/scaladoc.html" target="_blank">http://www.scala-lang.org/docu/files/tools/scaladoc.html</a></p>

<h2 id="sed">sed</h2>

<h3 id="section-8">ファイルの中のテキストを全置換するには</h3>

<pre><code>sed -i -e 's/置換前/置換後/g' ファイル名
</code></pre>

<p><code>-i</code> を取ると、全置換後の結果を標準出力に吐き出して、ファイルは書き換えない。</p>

<h2 id="source-highlight">source-highlight</h2>

<p>基本的な使い方</p>

<pre><code>source-highlight --falesafe --infer-lang -f esc --line-number -i ファイル名
</code></pre>

<p><code>--infer-lang</code> を付けると、拡張子やコマンドラインオプションからの指定よりも、ファイルの中身からファイルの種類を推定するほうを優先してくれる。中身と行っても、バージョン2.5の段階ではshebangからの推定のみのよう。詳しくは<br />
<a href="http://www.geocities.jp/harddiskdive/source-highlight/source-highlight_36.html#How-the-input-language-is-discovered" target="_blank">http://www.geocities.jp/harddiskdive/source-highlight/source-highlight_36.html#How-the-input-language-is-discovered</a></p>

<p><code>-f esc</code> はエスケープシーケンスを使って色付きで出力してくれるので、端末で直接見るのに便利。<code>-f html</code> とすると、HTMLフォーマットで出力される。</p>

<p><code>--line-number</code> は行番号をつけてくれる。</p>

<p><code>-i ファイル名</code> を付けないと、標準入力からソースを読もうとする。その場合、拡張子からのファイル種類の推定ができない。</p>

<p>GNU Source-highlight のマニュアルの和訳<br />
<a href="http://www.geocities.jp/harddiskdive/source-highlight/source-highlight_toc.html" target="_blank">http://www.geocities.jp/harddiskdive/source-highlight/source-highlight_toc.html</a></p>

<h2 id="ssh">ssh</h2>

<p><i>-&gt; <a href="ssh.html">SSH</a></i></p>

<h2 id="tar">tar</h2>

<h3 id="section-9">基本操作</h3>

<pre><code># 圧縮
tar cvzf tarファイル名 圧縮対象ディレクトリ

# 解凍
tar xvzf tarファイル名
</code></pre>

<h3 id="tar">tarファイルの中にあるファイルの一覧を見るには</h3>

<pre><code>tar tzf tarファイル名
</code></pre>

<h2 id="touch">touch</h2>

<h3 id="touch-">touch でファイルのタイムスタンプを変更する方法</h3>

<pre><code>touch -t 日時 ファイル名
</code></pre>

<p>日時は <code>YYMMDDHHmm.ss</code> の書式。</p>

<h2 id="tr">tr</h2>

<h3 id="section-10">ファイルの特定の文字を改行に全置換するには</h3>

<pre><code>cat 変更前ファイル名 | tr '&gt;' '\n' &gt; 変更後ファイル名
</code></pre>

<p>この例だと、<code>'&gt;'</code> という1文字を削除してかわりに改行にする。trでは <code>'&gt;'</code> の後ろに改行を付ける、ということができない。</p>

<h3 id="section-11">ファイルの特定の文字を削除するには</h3>

<pre><code>cat 変更前ファイル名 | tr -d '\n' &gt; 変更後ファイル名
</code></pre>

<p>この例だと、改行をすべて削除する。</p>

<h2 id="watch">watch</h2>

<p><code>ls</code> を1秒ごとに実行</p>

<pre><code>watch -n 1 ls -al
</code></pre>

<p>ファイルの数を1秒ごとに監視</p>

<pre><code>watch -n 1 "ls | wc -l"
</code></pre>

<h2 id="wget">wget</h2>

<p>GNU Wget 1.12 Manual<br />
<a href="http://www.gnu.org/software/wget/manual/wget.html" target="_blank">http://www.gnu.org/software/wget/manual/wget.html</a></p>

<p>GNU Wget 1.9 Manual 日本語<br />
<a href="http://www.bookshelf.jp/texi/wget/wget-ja.html" target="_blank">http://www.bookshelf.jp/texi/wget/wget-ja.html</a></p>

<h3 id="section-12">ウェブサイトを丸ごとダウンロードするには</h3>

<p>ウェブサイトを第3階層までリンクをたどりダウンロードする。</p>

<pre><code>wget -r -l3 URL
</code></pre>

<p>ウェブサイトを第5階層までリンクをたどりダウンロードする。かつローカルでサイトを閲覧できるように、パスを相対パスに書き換える。</p>

<pre><code>wget -r -l5 --convert-links URL
</code></pre>

<h2 id="zip">zip</h2>

<h3 id="zip">ディレクトリまるごとzip圧縮するには</h3>

<pre><code>zip -r ZIPファイル名 対象ディレクトリ
</code></pre>

<p>tarでの以下に相当する。</p>

<pre><code>tar cvzf TARGZファイル名 対象ディレクトリ
</code></pre>

<h3 id="zip-1">zipファイルを解凍するには</h3>

<pre><code>unzip ZIPファイル名
</code></pre>

<p>tarでの以下に相当する。</p>

<pre><code>tar xvzf TARGZファイル名
</code></pre>

<h3 id="section-13">ウェブサイトを丸ごとダウンロードするには</h3>

<p>ウェブサイトを第3階層までリンクをたどりダウンロードする</p>

<pre><code>wget -r -l3 URL
</code></pre>

<p>ウェブサイトを第5階層までリンクをたどりダウンロードする。かつローカルでサイトを閲覧できるように、パスを相対パスに書き換える。</p>

<pre><code>wget -r -l5 --convert-links URL
</code></pre>


</div>
<footer>
  <a href="./">目次</a>
  <!-- Copyright &copy; 2012- @hydrocul All Rights Reserved. -->
</footer>
</body>
</html>
